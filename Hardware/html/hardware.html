<h1>Hardware</h1>

<h2>Components</h2>

<p>Now all the pieces that the SCK consists of will be described. Along each product a link will be attached which redirects to their datasheet.</p>

<h2>Core components</h2>

<h3>RTC Clock</h3>

<p>The core board utilises a crystal oscillator that acts as a 16MHz real time clock. It needs an external power source to ensure it is always working and that is why you need to place a button cell in the bottom part of the core board.</p>

<h3>Atmel Mega 32U4-AU</h3>

<p>As for the central processing unit the SCK uses an AVR chip from Atmel, as the Arduino Leonardo does. This is a low power, high performance 8-bit microcontroller, which at the same time has USB built-in capabilities, which allows operating systems to recognise it as a regular mouse.</p>

<h3>Energy modules</h3>

<h4>Solar panel</h4>

<p>Any solar panel can be soldered to the board while it matches at least our <a href="http://#">minimum requirements</a>, that is:
- 7V
- 500mA</p>

<h4>Battery</h4>

<p>The battery we provide with the kit is powerful enough to power the SCK for a few consecutive days. However, if USB charging wants to be avoided a solar panel should be attached to the board.</p>

<p>Keep in mind that some tasks are more energy comsuming than others. For instance, writing information to the microSD card consumes less energy than directly uploading real-time information to the Internet.</p>

<p>Also, other parameters can be tuned by manually modifying the firmware in order to obtain more battery life. For instance, you can change the value of <code>transmit</code> global variable so communication with the remote database takes place less often (thus saving energy).</p>

<h4>USB interface</h4>

<p>Through the USB interface you can either charge the battery, see the output of debug mode or configure the board through our Processing application.</p>

<h3>WiFly</h3>

<p>This module enables a device to communicate using the standard IEEE 802.11 (Wi-Fi) b/g versions. It is Arduino friendly and the libraries can be found on <a href="https://github.com/sparkfun/WiFly-Shield">GitHub</a>, originally released by <a href="http://sparkfun.com">Sparkfun</a>. The libraries that the SCK uses are not the original ones. They are a lightweight modified version, specially built for the sake of this project.</p>

<h3>Connection socket</h3>

<p>TBD.</p>

<h3>microSD card</h3>

<p>When an Internet connection is not available, data is timestamped and saved in the microSD card, which allows to later upload all the gathered information.</p>

<h2>Ambient shield components</h2>

<p>This shield measures, as its name indicates, environmental factors. More precisely: temperature, humidity, CO, NO2, light and noise.</p>

<h3>Temperature and humidity</h3>

<p>This two measurements are obtained thanks to the <a href="http://dlnmh9ip6v2uc.cloudfront.net/datasheets/Sensors/Weather/RHT03.pdf">DHT22 sensor</a>, manufactured by Aosong Electronics, a Chinese corporation. They are quite cheap (you can obtain it for around $12USD) and are very precise. The output is not in analogic form but in digital form, meaning that the signal is in the either ones or zeros, thus requiring some extra "intelligence" to interpret the results.</p>

<p><img src="../pics/dht22" alt="DHT22 Sensor" title=""></p>

<p>The necessary libraries are already implemented to use along with Arduino and can be found in <a href="https://github.com/nethoncho/Arduino-DHT22">GitHub</a>. They were initially developed by Ben Adams in 2011 and implements a non-standard single wire protocol, necessary to establish a successful connection between Arduino and the sensor.</p>

<h3>CO</h3>

<p>Carbon monoxide levels are measured through the <a href="http://www.e2v.com/e2v/assets/File/sensors_datasheets/metal_oxide/MICS-5525.pdf">MiCS 5525 sensor</a>, a sensor made by e2v. This time the output is not digital but analogic. That means the sensing resistance decreases when CO is around. The main structure of this sensor consists on a heating resistor and the previously mentioned sensing layer. </p>

<p>CO levels are inversely proportional to <code>Rs/R0</code>, as it can be seen on the datasheet. <code>Rs</code> is varies in an inversely proportional manner to CO levels, and <code>R0</code> is a fixed sensing resistance whill shall be measured under controlled ambient conditions (it slightly varies from sensor to sensor). Since in the first iterations of the project we didn't have such conditions, we now upload <code>Rs</code> to the Internet. Later on, we will upload via firmware the value of <code>R0</code>, thus allowing to measure actual CO levels.</p>

<p>To measure CO levels a small procedure must be followed. Before reading, the sensor must be heated for 5 seconds, then let it cold for 9 seconds and finally perform a reading.</p>

<h3>NO2</h3>

<p>Nitrogen dioxide is measured buy another e2v sensor. In detail we are talking about the <a href="http://www.e2v.com/e2v/assets/File/sensors_datasheets/metal_oxide/MICS-2710.pdf">MiCS 2710</a>, a small, low power and precise NO2 sensor.</p>

<p>As it happens with the CO sensor, NO2 levels are also calculated in terms of <code>Rs</code> and <code>R0</code>. This time, <code>Rs/R0</code> is directly proportional to NO2 levels. And again, the information uploaded to the internet is just the value of <code>Rs</code> since <code>R0</code> couldn't be measured when the first ships shipped.</p>

<p>Before reading an actual value of <code>Rs</code>, the sensor must be heated until it reaches 220ÂºC. This is done by heating during 30s then perform a read.</p>

<h3>Light and noise</h3>

<p>To quantify light and noise levels we used a LDR (light dependant resitor) and a microphone. The market is highly saturated with this kind of components, but for the sake of this project we chose the following ones:
- LDR: <a href="http://www.farnell.com/datasheets/1475763.pdf">Excelitas Tech VT935G</a>
- Microphone: <a href="http://www.farnell.com/datasheets/1671459.pdf">Pro Signal ABM-705-RC</a></p>

<h3>2.4GHz ISM spectrum</h3>

<p>Although this is measured using the core component WiFly, it is an environmental factor as well. With a Wi-Fi enabled component we can check how many SSIDs are transmitting at one given time thus giving an approximate idea on how saturated is this band of the spectrum.</p>

<h2>Firmware</h2>

<p>The main firmware file called is the <code>*.ino</code> file you'll find in our <a href="https://github.com/fablabbcn/Smart-Citizen-Kit">github repository</a>. An overview on how it works can be seen on the next picture:</p>

<p><img src="../pics/SCK_firm.png" alt="SCK firmware flow diagram" title=""></p>
